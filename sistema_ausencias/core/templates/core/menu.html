{% extends 'core/base.html' %}

{% block content %}
<div class="row mb-4 align-items-center">
<div class="col">
<h2 class="text-white fw-bold">Bienvenido, {{ user.first_name|default:user.username }}</h2>
</div>
<div class="col-auto">
<a href="{% url 'crear_solicitud' %}" class="btn btn-primary fw-bold">+ Solicitar Nuevo Permiso</a>
</div>
</div>
<div class="row mb-5 g-4">
<div class="col-md-4">
<div class="card h-100 border-0 shadow-sm" style="background-color: #2c2c2c;">
<div class="card-body p-4">
<small class="text-secondary fw-bold text-uppercase ls-1">Dias Disponibles</small>
<h1 class="display-4 fw-bold text-success mt-2 mb-0">{{ dias_disponibles }}</h1>
<small class="text-muted">De {{ dias_totales }} dias totales</small>
</div>
</div>
</div>
<div class="col-md-4">
<div class="card h-100 border-0 shadow-sm" style="background-color: #2c2c2c;">
<div class="card-body p-4">
<small class="text-secondary fw-bold text-uppercase ls-1">Dias Tomados</small>
<h1 class="display-4 fw-bold text-warning mt-2 mb-0">{{ dias_tomados }}</h1>
<small class="text-muted">Vacaciones y permisos</small>
</div>
</div>
</div>
<div class="col-md-4">
<div class="card h-100 border-0 shadow-sm" style="background-color: #2c2c2c;">
<div class="card-body p-4">
<small class="text-secondary fw-bold text-uppercase ls-1">Proxima Ausencia</small>
<h1 class="display-4 fw-bold text-info mt-2 mb-0">-</h1>
<small class="text-muted">Sin ausencias programadas</small>
</div>
</div>
</div>
</div>
<div class="card shadow-lg border-0" style="background-color: #1e1e1e;">
<div class="card-header bg-transparent border-0 pt-4 px-4">
<h5 class="text-white fw-bold mb-0">Historial de Solicitudes</h5>
</div>
<div class="card-body p-0">
<div class="table-responsive">
<table class="table table-dark table-hover align-middle mb-0" style="background-color: transparent;">
<thead class="text-secondary border-bottom border-secondary">
<tr>
<th class="ps-4 py-3 small text-uppercase fw-bold">Tipo de Ausencia</th>
<th class="py-3 small text-uppercase fw-bold">Fecha Solicitud</th>
<th class="py-3 small text-uppercase fw-bold">Dias Solicitados</th>
<th class="text-end pe-4 py-3 small text-uppercase fw-bold">Estado</th>
</tr>
</thead>
<tbody>
{% for sol in solicitudes %}
<tr>
<td class="ps-4 fw-bold py-3">{{ sol.get_tipo_ausencia_display }}</td>
<td class="text-secondary">{{ sol.fecha_solicitud|date:"d/m/Y" }}</td>
<td><span class="text-white">{{ sol.fecha_inicio|date:"d/m/Y" }} - {{ sol.fecha_fin|date:"d/m/Y" }}</span></td>
<td class="text-end pe-4">
{% if sol.estado == 'aprobada' %}
<span class="badge bg-success bg-opacity-25 text-success rounded-pill px-3">Aprobado</span>
{% elif sol.estado == 'rechazada' %}
<span class="badge bg-danger bg-opacity-25 text-danger rounded-pill px-3">Rechazado</span>
{% else %}
<span class="badge bg-warning bg-opacity-25 text-warning rounded-pill px-3">Pendiente</span>
{% endif %}
</td>
</tr>
{% empty %}
<tr><td colspan="4" class="text-center py-5 text-muted">No tienes solicitudes registradas en el historial.</td></tr>
{% endfor %}
</tbody>
</table>
</div>
</div>
</div>
{% endblock %}